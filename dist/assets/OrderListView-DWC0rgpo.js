import{_ as ee,u as ae,r as d,H as te,i as le,o as oe,j as n,c as p,k as B,l as s,E as D,e as c,m as l,d as $,x as se,F as ne,z as m,s as F,g as _,L as re,q as M,y as q,p as de,f as ue}from"./index-D_kmQFyZ.js";import{a as ce,X as g}from"./XComponent-gqGWi3a1.js";import{S as ie,h as pe}from"./SearchService-B9NBS7vc.js";import{O as me}from"./OpenCardService-DI5upRg8.js";const _e=f=>(de("data-v-fc546f60"),f=f(),ue(),f),ge={class:"general-content"},fe={class:"number-range-container"},ve={class:"number-range"},he=_e(()=>c("div",{class:"to"},[c("span",null,"-")],-1)),be={key:0,class:"error-message"},Se={style:{display:"flex","align-items":"center"}},Ce={key:0,class:"pager"},ye={__name:"OrderListView",setup(f){const C=ae(),H=d([]),y=d(0),v=d(""),L=d(""),U=new me,E=new ie,o=te({chineseName:"",customerName:"",smallCardSize:"",minTotal:null,maxTotal:null}),I=d(null),h=d(""),b=d(""),k=d(1),w=d(14),T=d({});le(o,e=>{if(o.minTotal!==null&&o.maxTotal!==null&&o.maxTotal<o.minTotal){v.value="最大值不能小于最小值";return}v.value="";for(const a in e)(e[a]===""||e[a]===null)&&delete e[a];P({...e,startTime:h.value,endTime:b.value})});const X=e=>{if(e){const a=e.map(u=>{const V=u.getFullYear(),N=String(u.getMonth()+1).padStart(2,"0"),S=String(u.getDate()).padStart(2,"0"),z=String(u.getHours()).padStart(2,"0"),r=String(u.getMinutes()).padStart(2,"0"),x=String(u.getSeconds()).padStart(2,"0");return`${V}-${N}-${S} ${z}:${r}:${x}`});h.value=a[0],b.value=a[1]}else h.value="",b.value="";P({...o,startTime:h.value,endTime:b.value})},P=e=>{for(const a in e)(e[a]===""||e[a]===null)&&delete e[a];T.value=e,i()},j=()=>{C.push("/opencard/createorder")},R=e=>{localStorage.setItem("orderDetails",JSON.stringify(e)),C.push(`/opencard/orderlist/detail/${e.id}`)},i=()=>{let e={pageSize:w.value,pageNum:k.value};T.value&&(e=Object.assign(e,T.value)),U.getList(e).then(a=>{H.value=a.data.orderList,y.value=a.data.totalPage}).catch(a=>{console.log(a),D.error(a)})},J=e=>{w.value=e,i()},A=e=>{k.value=e,i()};oe(()=>{E.getOptions().then(e=>{L.value=e.data}).catch(e=>{console.log(e)}),i()});const G=e=>{console.log(e),C.push({path:"/opencard/createorder",query:{id:e.id}})},K=e=>{U.deleteOrder(e.id).then(a=>{D.success("删除成功"),i()}).catch(a=>{console.log(a),D.error(a)})};return(e,a)=>{const u=n("el-input"),V=n("el-option"),N=n("el-select"),S=n("el-input-number"),z=n("el-date-picker"),r=n("el-table-column"),x=n("el-tag"),Y=n("el-button"),Q=n("el-link"),W=n("el-table"),Z=n("el-pagination");return p(),B(ce,{title:"订单管理",onCreateOrder:j},{default:s(()=>[c("div",ge,[l(g,{label:"产品名称"},{default:s(()=>[l(u,{modelValue:o.productName,"onUpdate:modelValue":a[0]||(a[0]=t=>o.productName=t),placeholder:"请输入产品名称"},null,8,["modelValue"])]),_:1}),l(g,{label:"客户"},{default:s(()=>[l(u,{modelValue:o.customerName,"onUpdate:modelValue":a[1]||(a[1]=t=>o.customerName=t),placeholder:"请输入客户名称"},null,8,["modelValue"])]),_:1}),l(g,{label:"尺寸"},{default:s(()=>[l(N,{modelValue:o.smallCardSize,"onUpdate:modelValue":a[2]||(a[2]=t=>o.smallCardSize=t),placeholder:"请选择尺寸",clearable:""},{default:s(()=>[(p(!0),$(ne,null,se(L.value.cardSizes,(t,O)=>(p(),B(V,{key:O,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(g,{label:"数量"},{default:s(()=>[c("div",fe,[c("div",ve,[l(S,{placeholder:"最小值",modelValue:o.minTotal,"onUpdate:modelValue":a[3]||(a[3]=t=>o.minTotal=t),controls:!1},null,8,["modelValue"]),he,l(S,{placeholder:"最大值",modelValue:o.maxTotal,"onUpdate:modelValue":a[4]||(a[4]=t=>o.maxTotal=t),controls:!1},null,8,["modelValue"])]),v.value?(p(),$("div",be,m(v.value),1)):F("",!0)])]),_:1}),l(g,{label:"创建时间"},{default:s(()=>[l(z,{modelValue:I.value,"onUpdate:modelValue":a[5]||(a[5]=t=>I.value=t),type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-value":[new Date,new Date],onChange:X},null,8,["modelValue","default-value"])]),_:1})]),l(W,{data:H.value,style:{width:"100%"},onRowDblclick:R},{default:s(()=>[l(r,{prop:"productName",label:"产品名称","show-overflow-tooltip":!0},{default:s(t=>[_(m(t.row.productName)+"（"+m(t.row.chineseName)+"） ",1)]),_:1}),l(r,{prop:"customerName",label:"客户名字"}),l(r,{prop:"status",label:"状态"},{default:s(t=>[l(x,{type:["primary","warning","success","danger","danger"][t.row.status]},{default:s(()=>[_(m(["渲染中","待审核","已通过","未通过","渲染失败"][t.row.status]),1)]),_:2},1032,["type"])]),_:1}),l(r,{prop:"total",label:"数量"}),l(r,{prop:"smallCardSize",label:"尺寸"}),l(r,{prop:"businessPeople",label:"业务员"}),l(r,{prop:"createTime",label:"创建时间"},{default:s(t=>[c("div",Se,[c("span",null,m(re(pe)(t.row.createTime).format("YYYY-MM-DD HH:mm:ss")),1)])]),_:1}),l(r,{fixed:"right",label:"操作"},{default:s(t=>[l(Y,{link:"",type:"primary",size:"small",onClick:M(O=>G(t.row),["stop"]),class:q({"btn-disable":t.row.status==0}),disabled:t.row.status==0},{default:s(()=>[_(" 编辑 ")]),_:2},1032,["onClick","class","disabled"]),l(Q,{type:"primary",href:t.row.pdfOss,onClick:a[6]||(a[6]=M(()=>{},["stop"])),class:q({"btn-disable":t.row.status==0||t.row.status==4}),disabled:t.row.status==0||t.row.status==4},{default:s(()=>[_(" 下载 ")]),_:2},1032,["href","class","disabled"]),l(Y,{link:"",type:"danger",size:"small",onClick:M(O=>K(t.row),["stop"])},{default:s(()=>[_(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),y.value?(p(),$("div",Ce,[l(Z,{onSizeChange:J,onCurrentChange:A,"current-page":k.value,"page-size":w.value,layout:"prev, pager, next",background:"","page-count":y.value},null,8,["current-page","page-size","page-count"])])):F("",!0)]),_:1})}}},Ne=ee(ye,[["__scopeId","data-v-fc546f60"]]);export{Ne as default};
