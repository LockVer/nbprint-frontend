import{a as S,X as d}from"./XComponent-gqGWi3a1.js";import{_ as B,t as q,h as A,r as i,i as z,j as _,c as C,k as P,l as t,m as e,p as G,f as J,e as x,I as K,H as Q,o as T,d as U,z as m,g as r,s as W,L as Y,F as Z,O as ee}from"./index-D_kmQFyZ.js";import{l as te}from"./lodash-C7Pouijc.js";const le=v=>(G("data-v-fbb0b217"),v=v(),J(),v),ae=le(()=>x("div",{class:"label"},"部门",-1)),oe={__name:"ManagementNavView",props:{modelValue:{},modelModifiers:{}},emits:q(["checkChange"],["update:modelValue"]),setup(v,{expose:f,emit:g}){const k=A(v,"modelValue"),o=i(""),h=i(null),l=g,u={children:"children",label:"deptName"};z(o,c=>{h.value.filter(c)});const w=(c,b)=>(console.log(c,b),c?b.deptName.includes(c):!0),V=(c,b)=>{l("checkChange",c,b)};return f({treeRef:h}),(c,b)=>{const D=_("el-input"),M=_("el-tree");return C(),P(S,{title:"部门列表",cardStyle:{width:"310px"}},{default:t(()=>[ae,e(D,{modelValue:o.value,"onUpdate:modelValue":b[0]||(b[0]=L=>o.value=L),placeholder:"请输入查询内容",style:{"margin-bottom":"22px"}},null,8,["modelValue"]),e(M,{ref_key:"treeRef",ref:h,class:"filter-tree",data:k.value,props:u,"highlight-current":"","filter-node-method":w,onNodeClick:V,"node-key":"id"},null,8,["data"])]),_:1})}}},ne=B(oe,[["__scopeId","data-v-fbb0b217"]]);class E{constructor(){this.apiService=new K}getDepartmentsList(){return this.apiService.get("/dept/getListDict",{},!0)}getMembersList(f){return this.apiService.post("/user/getList",f,!0)}getMembersDetail(f){return this.apiService.get(`/user/getInfo?userId=${f}`,{},!0)}}const se={class:"search-content"},de={key:0,class:"pager"},ie={class:"deInfo"},ue={class:"image-slot"},re={class:"deInfo"},ce={__name:"ManagementTableView",props:{title:{type:String,default:""},titleId:{type:Number,default:1}},setup(v){const f=v,g=i([]),k=new E,o=Q({id:"",userName:"",gender:"",position:""});i({});const h=i(!1),l=i({}),u=i(1),w=i(16),V=i(0),c=i({});z(()=>f.titleId,()=>{for(const s in o)o[s]="";N()}),z(o,s=>{b(s)});const b=te.debounce(s=>{const a={...s};for(const n in a)(a[n]===""||a[n]===null)&&delete a[n];c.value=a,N()},1e3);T(()=>{N()});const D=s=>{h.value=!0,k.getMembersDetail(s.userId).then(a=>{l.value=a.data;for(const n in l.value)(l.value[n]==null||l.value[n]=="")&&(l.value[n]="-");console.log(l.value.avatar)})},M=s=>{w.value=s,N()},L=s=>{u.value=s,N()},N=()=>{let s={deptId:f.titleId,pageSize:w.value,pageNum:u.value};c.value&&(s=Object.assign(s,c.value)),k.getMembersList(s).then(a=>{g.value=a.data.userList,V.value=a.data.totalPage,g.value.forEach(n=>{for(const y in n)(n[y]==null||n[y]=="")&&(n[y]="-");n.gender=="-"&&(n.gender=0)})}).catch(a=>{console.log(a)})};return(s,a)=>{const n=_("el-input"),y=_("el-option"),F=_("el-select"),I=_("el-table-column"),R=_("el-button"),H=_("el-table"),X=_("el-pagination"),$=_("el-image"),j=_("el-icon"),O=_("el-dialog");return C(),U(Z,null,[e(S,{title:v.title,isHrmBtn:!0},{default:t(()=>[x("div",se,[e(d,{label:"ID",width:"15%"},{default:t(()=>[e(n,{modelValue:o.id,"onUpdate:modelValue":a[0]||(a[0]=p=>o.id=p),placeholder:"请输入ID"},null,8,["modelValue"])]),_:1}),e(d,{label:"姓名",width:"15%"},{default:t(()=>[e(n,{modelValue:o.userName,"onUpdate:modelValue":a[1]||(a[1]=p=>o.userName=p),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),e(d,{label:"性别",width:"15%"},{default:t(()=>[e(F,{modelValue:o.gender,"onUpdate:modelValue":a[2]||(a[2]=p=>o.gender=p),placeholder:"请选择性别",clearable:""},{default:t(()=>[e(y,{label:"男",value:"1"}),e(y,{label:"女",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"职位",width:"15%"},{default:t(()=>[e(n,{modelValue:o.position,"onUpdate:modelValue":a[3]||(a[3]=p=>o.position=p),placeholder:"请输入职位"},null,8,["modelValue"])]),_:1})]),e(H,{data:g.value,style:{width:"100%"},onRowDblclick:D},{default:t(()=>[e(I,{prop:"id",label:"ID"}),e(I,{prop:"userName",label:"姓名"}),e(I,{prop:"gender",label:"性别"},{default:t(p=>[x("div",null,m(["-","男","女"][p.row.gender]),1)]),_:1}),e(I,{prop:"position",label:"职位"}),e(I,{prop:"mobile",label:"电话"}),e(I,{fixed:"right",label:"操作"},{default:t(p=>[e(R,{disabled:"",link:""},{default:t(()=>[r("编辑")]),_:1}),e(R,{disabled:"",link:""},{default:t(()=>[r("删除")]),_:1})]),_:1})]),_:1},8,["data"]),V.value?(C(),U("div",de,[e(X,{onSizeChange:M,onCurrentChange:L,"current-page":u.value,"page-size":w.value,layout:"prev, pager, next",background:"","page-count":V.value},null,8,["current-page","page-size","page-count"])])):W("",!0)]),_:1},8,["title"]),e(O,{class:"new-dialog",modelValue:h.value,"onUpdate:modelValue":a[4]||(a[4]=p=>h.value=p),"close-on-click-modal":!1,title:"个人信息-"+l.value.userName,width:"870"},{default:t(()=>[e(S,{title:"基础信息",style:{padding:"0","box-shadow":"none"},headerStyle:{"margin-bottom":"12px"},titleStyle:{"font-size":"18px"}},{default:t(()=>[x("div",ie,[e(d,{label:"ID",width:"15%"},{default:t(()=>[r(m(l.value.id),1)]),_:1}),e(d,{label:"姓名",width:"15%"},{default:t(()=>[r(m(l.value.userName),1)]),_:1}),e(d,{label:"性别",width:"15%"},{default:t(()=>[r(m(["-","男","女"][l.value.gender]),1)]),_:1}),e(d,{label:"别名",width:"15%"},{default:t(()=>[r(m(l.value.alias),1)]),_:1}),e(d,{label:"电话",width:"15%"},{default:t(()=>[r(m(l.value.mobile),1)]),_:1}),e(d,{label:"座机",width:"15%"},{default:t(()=>[r(m(l.value.telephone),1)]),_:1}),e(d,{label:"地址",width:"15%"},{default:t(()=>[r(m(l.value.address),1)]),_:1}),e(d,{label:"企业邮箱",width:"15%"},{default:t(()=>[r(m(l.value.bizMail),1)]),_:1}),e(d,{label:"头像",width:"15%"},{default:t(()=>[l.value.avatar!=="-"?(C(),P($,{key:0,style:{width:"36px",height:"36px"},src:l.value.avatar},null,8,["src"])):(C(),P($,{key:1},{error:t(()=>[x("div",ue,[e(j,null,{default:t(()=>[e(Y(ee))]),_:1})])]),_:1}))]),_:1})])]),_:1}),e(S,{title:"职务信息",style:{padding:"0","box-shadow":"none"},headerStyle:{"margin-bottom":"12px"},titleStyle:{"font-size":"18px"}},{default:t(()=>[x("div",re,[e(d,{label:"职位",width:"15%"},{default:t(()=>[r(m(l.value.position),1)]),_:1}),e(d,{label:"所属部门",width:"15%"},{default:t(()=>[r(m(l.value.mainDepartment),1)]),_:1}),e(d,{label:"直属上级",width:"15%"},{default:t(()=>[r(m(l.value.directLeader==null?"-":l.value.directLeader),1)]),_:1})])]),_:1})]),_:1},8,["modelValue","title"])],64)}}},pe=B(ce,[["__scopeId","data-v-e7b68f61"]]),me={class:"container"},_e={__name:"PersonnelManagementView",setup(v){const f=new E,g=i([]),k=i(null),o=i(""),h=i(1);T(()=>{f.getDepartmentsList().then(u=>{g.value=u.data,l(g.value[0])}).catch(u=>{console.log(u)})});const l=u=>{o.value=u.deptName,h.value=u.deptId};return(u,w)=>(C(),U("div",me,[e(ne,{modelValue:g.value,"onUpdate:modelValue":w[0]||(w[0]=V=>g.value=V),onCheckChange:l,ref_key:"hrmNavRef",ref:k},null,8,["modelValue"]),e(pe,{title:o.value,titleId:h.value},null,8,["title","titleId"])]))}},he=B(_e,[["__scopeId","data-v-79e40f58"]]);export{he as default};
